# Blog Automation Deployment Checklist

Use this checklist to deploy the blog article automation feature step-by-step.

## Pre-Deployment Verification

### Code Review
- [x] All code implemented and tested
- [x] Code review feedback addressed
- [x] Security review completed
- [x] Documentation complete

### Environment Preparation
- [ ] Vercel project is accessible
- [ ] Make.com account created (free or paid)
- [ ] Admin credentials for Where2Go available

## Deployment Steps

### Step 1: Review Implementation (5 minutes)

- [ ] Read [BLOG_AUTOMATION_IMPLEMENTATION_SUMMARY.md](BLOG_AUTOMATION_IMPLEMENTATION_SUMMARY.md)
- [ ] Understand the architecture and flow
- [ ] Review cost analysis ($17.64/month for Wien)
- [ ] Note the schedule: 6:15 AM UTC daily

**Documentation to Review:**
- Quick overview: `BLOG_AUTOMATION_IMPLEMENTATION_SUMMARY.md`
- Complete guide: `BLOG_ARTICLE_AUTOMATION.md`
- Quick reference: `docs/QUICK_REFERENCE.md`

### Step 2: Set Up Make.com Scenario (30 minutes)

- [ ] Log into [Make.com](https://www.make.com)
- [ ] Create new scenario: "Where2Go Blog Article Generator"
- [ ] Follow step-by-step guide: [docs/make-com-scenario-example.md](docs/make-com-scenario-example.md)

**Module 1: Webhook Trigger**
- [ ] Add "Webhooks → Custom webhook"
- [ ] Create new webhook
- [ ] Copy webhook URL (save for Step 3)
- [ ] Test with sample data

**Module 2: AI Content Generation**
- [ ] Add "OpenAI → Create completion" OR
- [ ] Add "HTTP → Anthropic API"
- [ ] Configure API key
- [ ] Set up prompt (copy from guide)
- [ ] Test module

**Module 3: JSON Parser**
- [ ] Add "JSON → Parse JSON"
- [ ] Connect to AI module output
- [ ] Test parsing

**Module 4: HTTP POST to Blog API**
- [ ] Add "HTTP → Make a request"
- [ ] URL: `https://your-domain.vercel.app/api/admin/blog-articles`
- [ ] Method: POST
- [ ] Headers:
  - [ ] `X-API-Secret: {your INTERNAL_API_SECRET}`
  - [ ] `Content-Type: application/json`
- [ ] Body: Map fields from JSON parser
- [ ] Test request

**Module 5: Error Handler (Optional)**
- [ ] Right-click Module 4 → Add error handler
- [ ] Add "Break" directive
- [ ] Configure logging

**Scenario Settings:**
- [ ] Set scheduling to ON
- [ ] Enable error notifications
- [ ] Add your email for alerts

**Test Complete Scenario:**
- [ ] Click "Run once"
- [ ] Send test webhook (command in guide)
- [ ] Verify article created in admin panel
- [ ] Check all modules executed successfully

### Step 3: Configure Vercel Environment Variables (2 minutes)

- [ ] Go to Vercel Dashboard → Your Project
- [ ] Navigate to Settings → Environment Variables

**Add Required Variables:**
- [ ] `MAKE_COM_WEBHOOK_URL` = `https://hook.eu1.make.com/xxxxx`
  - Value: Copy from Make.com webhook (Module 1)
  - Scope: Production, Preview, Development

**Verify Existing Variables:**
- [ ] `CRON_SECRET` exists (auto-generated by Vercel)
- [ ] `INTERNAL_API_SECRET` exists and is strong (min 32 chars)
- [ ] `ADMIN_USER` exists (for admin panel access)
- [ ] `ADMIN_PASS` exists (for admin panel access)

**Optional Multi-City:**
- [ ] `BLOG_GENERATION_CITIES` = `wien,berlin,linz`
  - Only add if you want multiple cities
  - Defaults to "wien" if not set
  - Increases costs proportionally

### Step 4: Deploy to Production (5 minutes)

- [ ] Review PR changes one final time
- [ ] Merge PR into main branch
- [ ] Wait for Vercel deployment to complete
- [ ] Check deployment logs for errors

**Verify Deployment:**
- [ ] Visit your site to ensure it's working
- [ ] Check Vercel Dashboard → Deployments
- [ ] Confirm build succeeded

### Step 5: Verify Cron Job Configuration (2 minutes)

- [ ] Go to Vercel Dashboard → Your Project
- [ ] Navigate to Cron Jobs tab
- [ ] Verify `/api/cron/generate-blog-articles` is listed
- [ ] Verify schedule shows: `15 6 * * *` (6:15 AM UTC)
- [ ] Verify status is "Active"

**If cron job is not listed:**
- [ ] Check `vercel.json` has correct configuration
- [ ] Redeploy project
- [ ] Contact Vercel support if issue persists

### Step 6: Test Integration (10 minutes)

**Test Cron Job Manually:**
- [ ] Get your `CRON_SECRET` from Vercel environment variables
- [ ] Run test script: `./scripts/test-blog-cron.sh https://your-domain.vercel.app`
- [ ] Verify HTTP 200 response
- [ ] Verify `successCount: 12` (or 36 for 3 cities)

**Expected Output:**
```
Testing Blog Article Automation
HTTP Status: 200
{
  "success": true,
  "cities": ["wien"],
  "totalTriggers": 12,
  "successCount": 12,
  "failureCount": 0
}
✓ Cron job executed successfully
```

**Check Make.com:**
- [ ] Go to Make.com → Scenarios → Execution History
- [ ] Verify 12 executions (one per category)
- [ ] Check each execution succeeded
- [ ] Review any errors

**Check Admin Panel:**
- [ ] Visit `https://your-domain.vercel.app/admin/blog-articles`
- [ ] Log in with `ADMIN_USER` and `ADMIN_PASS`
- [ ] Verify 12 new draft articles appear
- [ ] Open one article to review quality
- [ ] Check title, content, meta description

**If articles not appearing:**
- [ ] Check Make.com execution logs for errors
- [ ] Verify `INTERNAL_API_SECRET` matches in both systems
- [ ] Check Vercel function logs for API errors
- [ ] Review [Troubleshooting Guide](BLOG_ARTICLE_AUTOMATION.md#troubleshooting)

### Step 7: Wait for First Scheduled Run (Next Day)

- [ ] Note the time: 6:15 AM UTC (check your local timezone)
- [ ] Set reminder for morning after
- [ ] Prepare to check logs

**Next Morning (After 7:00 AM UTC):**
- [ ] Check Vercel Logs for cron execution
- [ ] Check Make.com execution history
- [ ] Check admin panel for new draft articles
- [ ] Review article quality

### Step 8: Review and Publish First Batch (30 minutes)

**Review Articles:**
- [ ] Visit `/admin/blog-articles`
- [ ] Filter by: Status = Draft, City = Wien
- [ ] Review each article for:
  - [ ] Title is appropriate
  - [ ] Content is relevant and accurate
  - [ ] Meta description is compelling
  - [ ] SEO keywords are relevant
  - [ ] No formatting issues

**Edit if Needed:**
- [ ] Click "Edit" on article
- [ ] Make any necessary corrections
- [ ] Save changes

**Publish Articles:**
- [ ] Select best articles (quality first)
- [ ] Click "Publish" for each
- [ ] Verify `published_at` timestamp is set
- [ ] Articles are now live

### Step 9: Configure Monitoring (15 minutes)

**Vercel Monitoring:**
- [ ] Set up log alert for failed cron executions
- [ ] Monitor function execution times
- [ ] Set budget alert for costs

**Make.com Monitoring:**
- [ ] Enable email notifications for errors
- [ ] Monitor operations usage (10,000/month on Core plan)
- [ ] Check execution history daily (first week)

**AI Provider Monitoring:**
- [ ] OpenAI/Anthropic: Check token usage
- [ ] Set budget limit (e.g., $20/month)
- [ ] Enable email alerts for high usage

**Cost Tracking:**
- [ ] Set up spreadsheet or tool to track monthly costs
- [ ] Expected: ~$17.64/month (Wien only)
- [ ] Review costs weekly for first month

### Step 10: Document Your Setup (10 minutes)

**Create Internal Documentation:**
- [ ] Document your Make.com scenario (screenshot)
- [ ] Save webhook URL securely (password manager)
- [ ] Document any customizations made
- [ ] Note any issues encountered and resolutions

**Share with Team:**
- [ ] Share access to admin panel
- [ ] Train team on article review process
- [ ] Establish publishing workflow
- [ ] Define quality standards

## Post-Deployment

### Daily Tasks (5 minutes/day)
- [ ] Check Make.com execution history (any errors?)
- [ ] Quick review of generated articles

### Weekly Tasks (30 minutes/week)
- [ ] Review and publish draft articles
- [ ] Check costs vs budget
- [ ] Review article quality trends
- [ ] Adjust AI prompts if needed

### Monthly Tasks (1 hour/month)
- [ ] Full cost analysis
- [ ] Review all published articles
- [ ] Optimize prompts for better quality
- [ ] Check for any security issues
- [ ] Backup important data

### Quarterly Tasks (2 hours/quarter)
- [ ] Rotate `INTERNAL_API_SECRET`
- [ ] Update Make.com scenario if needed
- [ ] Full security review
- [ ] Consider expanding to new cities
- [ ] Review and update documentation

## Troubleshooting

### Issue: Articles not being generated

**Check:**
1. [ ] Vercel cron job is running (check logs)
2. [ ] Make.com scenario is active
3. [ ] Webhook URL is correct in Vercel
4. [ ] `INTERNAL_API_SECRET` matches in both systems

**Solution:**
- Review [Troubleshooting Guide](BLOG_ARTICLE_AUTOMATION.md#troubleshooting)
- Test each component individually
- Check all logs (Vercel, Make.com, API)

### Issue: Poor quality articles

**Check:**
1. [ ] AI prompt is clear and specific
2. [ ] Using appropriate AI model (Claude 3.5 Sonnet recommended)
3. [ ] Enough context provided in prompt

**Solution:**
- Refine AI prompt in Make.com scenario
- Add more examples or constraints
- Consider switching AI model

### Issue: Costs too high

**Check:**
1. [ ] How many cities configured?
2. [ ] Which AI model being used?
3. [ ] Make.com operations count

**Solution:**
- Use GPT-3.5-turbo instead of GPT-4
- Reduce to 6 categories instead of 12
- Change to weekly schedule
- Generate only for Wien

### Issue: Cron job not running

**Check:**
1. [ ] Cron job listed in Vercel Dashboard?
2. [ ] Schedule correct (15 6 * * *)?
3. [ ] `CRON_SECRET` environment variable set?

**Solution:**
- Check `vercel.json` configuration
- Redeploy project
- Contact Vercel support

## Success Criteria

### Week 1
- [ ] Cron job runs successfully every day
- [ ] 12 articles generated daily (Wien)
- [ ] No errors in logs
- [ ] First 10 articles published

### Month 1
- [ ] ~360 articles generated (Wien)
- [ ] ~50+ articles published
- [ ] Costs within budget ($20)
- [ ] Article quality is acceptable
- [ ] Team trained on review process

### Quarter 1
- [ ] System runs smoothly with minimal intervention
- [ ] Consistent article quality
- [ ] Costs optimized
- [ ] Consider expansion to new cities

## Need Help?

**Documentation:**
- [Quick Reference](docs/QUICK_REFERENCE.md) - Commands & cheat sheet
- [Make.com Guide](docs/make-com-scenario-example.md) - Detailed setup
- [Complete Guide](BLOG_ARTICLE_AUTOMATION.md) - Full documentation
- [Security Guide](SECURITY_SUMMARY_BLOG_AUTOMATION.md) - Security info

**Support:**
- GitHub Issues: For bugs or feature requests
- Documentation: Check troubleshooting sections
- Logs: Review Vercel, Make.com, and API logs

---

**Checklist Last Updated**: December 2024
**Version**: 1.0

**Remember**: The hardest part (code) is done! This checklist just walks you through configuration and deployment.

**Total Time**: ~2 hours for complete setup
**Ongoing Time**: ~30-60 min/week for article review
